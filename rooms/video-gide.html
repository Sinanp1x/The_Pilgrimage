<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>THE PILGRIMAGE</title>
  <link rel="icon" href="assets/favicon.png" type="image/png">
  <style>
    :root {
      --bg: #0f0f0f;
      --fg: #ffffff;
      --accent: #8b5e34;
      --muted: #ffffffcc;
    }
    * { box-sizing: border-box }
    html, body { margin:0; height:100%; background:var(--bg); color:var(--fg); font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
    .wrap {
      min-height:100%;
      display:grid;
      place-items:center;
      padding:12px;
    }
    .player {
      position:relative;
      width:min(100vw, 900px);
      aspect-ratio: 16 / 9;
      background:#000;
      border-radius:16px;
      overflow:hidden;
      box-shadow:0 8px 30px #0008;
    }
    video {
      width:100%;
      height:100%;
      display:block;
      background:#000;
    }
    /* tap-to-seek zones */
    .tap-zone {
      position:absolute; top:0; bottom:64px; width:50%; /* leave room for controls */
    }
    .tap-left  { left:0; }
    .tap-right { right:0; }
    /* faint ripple feedback */
    .flash {
      position:absolute; inset:0; pointer-events:none; opacity:0; transition:opacity .25s;
      background: radial-gradient(ellipse at var(--x,50%) var(--y,50%), #fff4, transparent 40%);
    }
    .flash.show { opacity:1 }

    /* controls bar */
    .controls {
      position:absolute; left:0; right:0; bottom:0;
      background:linear-gradient(180deg, transparent, #0009);
      padding:10px 12px 14px;
      display:flex; align-items:center; gap:10px;
      backdrop-filter:saturate(140%) blur(2px);
    }
    .btn {
      appearance:none; border:0; border-radius:999px;
      background:#ffffff1a; color:var(--fg);
      width:44px; height:44px; display:grid; place-items:center; cursor:pointer;
      transition:background .2s, transform .05s;
    }
    .btn:focus-visible { outline:2px solid var(--accent); outline-offset:2px }
    .btn:hover { background:#ffffff28 }
    .btn:active { transform:scale(.97) }

    .speed {
      margin-left:auto;
      background:#ffffff1a; color:var(--fg);
      border:0; border-radius:10px; padding:10px 12px;
    }
    .time {
      font-variant-numeric: tabular-nums;
      color:var(--muted);
      min-width:110px; text-align:center;
    }
    .progress {
      flex:1; height:6px; border-radius:999px; background:#ffffff26; position:relative; cursor:pointer;
    }
    .progress .bar {
      position:absolute; left:0; top:0; bottom:0;
      background:var(--accent); border-radius:999px; width:0%;
    }
    .sr-only {
      position:absolute !important; width:1px; height:1px; padding:0; margin:-1px;
      overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="player" role="region" aria-label="Custom video player">
      <!-- Replace with your file and (optional) poster -->
      <video id="video" preload="metadata" playsinline webkit-playsinline>
        <source src="../pdfs/guide.mp4" type="video/mp4" />
        <!-- Optional captions (recommended for accessibility) -->
        <!-- <track kind="captions" src="assets/captions/guide.en.vtt" srclang="en" label="English" default> -->
        Sorry, your browser doesn‚Äôt support embedded videos.
      </video>

      <!-- double-tap zones -->
      <div class="tap-zone tap-left"  aria-label="Double tap to rewind 10 seconds"></div>
      <div class="tap-zone tap-right" aria-label="Double tap to skip forward 10 seconds"></div>
      <div class="flash" aria-hidden="true"></div>

      <!-- controls -->
      <div class="controls">
        <button class="btn" id="play" aria-label="Play (K)">
          ‚ñ∂Ô∏è
        </button>

        <div class="time" aria-live="polite" id="time">00:00 / 00:00</div>

        <div class="progress" id="progress" aria-label="Seek bar" role="slider" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" tabindex="0">
          <div class="bar" id="bar"></div>
        </div>

        <button class="btn" id="mute" aria-label="Mute (M)">
          üîä
        </button>

        <select id="speed" class="speed" aria-label="Playback speed">
          <option value="0.5">0.5√ó</option>
          <option value="0.75">0.75√ó</option>
          <option value="1" selected>1.0√ó</option>
          <option value="1.25">1.25√ó</option>
          <option value="1.5">1.5√ó</option>
          <option value="1.75">1.75√ó</option>
          <option value="2">2.0√ó</option>
        </select>
      </div>
    </div>
  </div>

  <script>
    const video   = document.getElementById('video');
    const playBtn = document.getElementById('play');
    const speed   = document.getElementById('speed');
    const timeEl  = document.getElementById('time');
    const progress= document.getElementById('progress');
    const bar     = document.getElementById('bar');
    const zoneL   = document.querySelector('.tap-left');
    const zoneR   = document.querySelector('.tap-right');
    const flash   = document.querySelector('.flash');
    const muteBtn = document.getElementById('mute');

    // iOS inline playback friendly defaults
    video.controls = false; // we use custom controls
    video.playsInline = true;
    video.setAttribute('playsinline','');

    // helpers
    const fmt = s => {
      s = Math.max(0, Math.floor(s));
      const m = Math.floor(s/60).toString().padStart(2,'0');
      const ss = (s%60).toString().padStart(2,'0');
      return `${m}:${ss}`;
    };
    const updateTime = () => {
      timeEl.textContent = `${fmt(video.currentTime)} / ${fmt(isFinite(video.duration)?video.duration:0)}`;
      const pct = video.duration ? (video.currentTime / video.duration) * 100 : 0;
      bar.style.width = `${pct}%`;
      progress.setAttribute('aria-valuenow', Math.round(pct));
    };

    function togglePlay() {
      if (video.paused) { video.play(); }
      else { video.pause(); }
      playBtn.textContent = video.paused ? '‚ñ∂Ô∏è' : '‚è∏Ô∏è';
    }

    function toggleMute() {
      video.muted = !video.muted;
      muteBtn.textContent = video.muted ? 'üîá' : 'üîä';
      muteBtn.setAttribute('aria-label', video.muted ? 'Unmute (M)' : 'Mute (M)');
    }

    playBtn.addEventListener('click', togglePlay);
    video.addEventListener('click', togglePlay); // click on video toggles

    muteBtn.addEventListener('click', toggleMute);

    // Also update button if user mutes with keyboard shortcut (M)
    video.addEventListener('volumechange', () => {
      muteBtn.textContent = video.muted ? 'üîá' : 'üîä';
      muteBtn.setAttribute('aria-label', video.muted ? 'Unmute (M)' : 'Mute (M)');
    });

    speed.addEventListener('change', () => {
      video.playbackRate = parseFloat(speed.value);
      speed.blur();
    });

    video.addEventListener('timeupdate', updateTime);
    video.addEventListener('loadedmetadata', updateTime);
    video.addEventListener('play', () => playBtn.textContent = '‚è∏Ô∏è');
    video.addEventListener('pause', () => playBtn.textContent = '‚ñ∂Ô∏è');

    // progress click/drag seek
    const seek = (clientX) => {
      const rect = progress.getBoundingClientRect();
      const pct = Math.min(1, Math.max(0, (clientX - rect.left) / rect.width));
      if (video.duration) video.currentTime = pct * video.duration;
    };
    progress.addEventListener('click', e => seek(e.clientX));

    // keyboard accessibility
    document.addEventListener('keydown', (e) => {
      if (['INPUT','TEXTAREA','SELECT'].includes(e.target.tagName)) return;
      switch (e.key.toLowerCase()) {
        case ' ': case 'k': e.preventDefault(); togglePlay(); break;
        case 'j': video.currentTime = Math.max(0, video.currentTime - 10); break;
        case 'l': video.currentTime = Math.min(video.duration||0, video.currentTime + 10); break;
        case 'arrowup': video.volume = Math.min(1, video.volume + 0.05); break;
        case 'arrowdown': video.volume = Math.max(0, video.volume - 0.05); break;
        case 'm': video.muted = !video.muted; break;
        case '+': case '=': video.playbackRate = Math.min(2, (video.playbackRate + 0.25)); speed.value = video.playbackRate; break;
        case '-': case '_': video.playbackRate = Math.max(0.5, (video.playbackRate - 0.25)); speed.value = video.playbackRate; break;
      }
    });

    // double-tap on mobile to seek ¬±10s
    function makeDoubleTapHandler(skipSeconds, zoneElement) {
      let last = 0;
      zoneElement.addEventListener('touchstart', (e) => {
        const now = performance.now();
        if (now - last < 300) {
          // position for ripple feedback
          const t = e.touches[0];
          const rect = zoneElement.getBoundingClientRect();
          flash.style.setProperty('--x', `${((t.clientX-rect.left)/rect.width)*100}%`);
          flash.style.setProperty('--y', `${((t.clientY-rect.top)/rect.height)*100}%`);
          flash.classList.add('show');
          setTimeout(()=>flash.classList.remove('show'), 180);

          // do the skip
          const target = Math.max(0, Math.min((video.duration||0), video.currentTime + skipSeconds));
          video.currentTime = target;
          updateTime();
        }
        last = now;
      }, { passive: true });
    }
    makeDoubleTapHandler(-10, zoneL);
    makeDoubleTapHandler(+10, zoneR);

    // also support double-click on desktop
    zoneL.addEventListener('dblclick', () => { video.currentTime = Math.max(0, video.currentTime - 10); });
    zoneR.addEventListener('dblclick', () => { video.currentTime = Math.min(video.duration||0, video.currentTime + 10); });

    // Allow dragging the slider with keyboard (left/right)
    progress.addEventListener('keydown', (e) => {
      if (!video.duration) return;
      const step = (e.shiftKey ? 0.05 : 0.01) * video.duration;
      if (e.key === 'ArrowLeft') { video.currentTime = Math.max(0, video.currentTime - step); e.preventDefault(); }
      if (e.key === 'ArrowRight'){ video.currentTime = Math.min(video.duration, video.currentTime + step); e.preventDefault(); }
    });
  </script>
</body>
</html>
``` 
